<!DOCTYPE html>
<html lang="en">
<head>
   <meta charset="utf-8">
   <title>Visualized Indoor Occupancy Detection System</title>
   <script src="https://d3js.org/d3.v4.min.js"></script>
</head>

<body>
    <div id="chartContainer">
        <h1><center>Web Portal for Data Visualization testing</center></h1>
        <canvas id="chart_1" width="800" height="300"></canvas> data source: <input name="number"></input>
        <br>
        <canvas id="chart_2" width="800" height="300"></canvas>

        <br>
        Occupied by Humans: <input autocomplete="off" id="occupied" type="text" readonly="readonly" value="Yes" />
    </div>
    
    <div id="chart"></div>
    <script src="script.js"></script>
<!--    
    <script src="multiline.js" charset="utf-8"></script>
    <script type="text/javascript">
    d3.csv('/data/data_stored.csv', function(error, data) {
    data.forEach(function (d) {
        d.time = +d.time;
        d.data1 = +d.data1;
        d.data2 = +d.data2;
        d.data3 = +d.data3;
        d.data4 = +d.data4;
        d.data5 = +d.data5;
    });

    var chart = makeLineChart(data, 'time', {
        'data1': {column: 'data1'},
        'data2': {column: 'data2'},
        'data3': {column: 'data3'},
        'data4': {column: 'data4'}
    }, {xAxis: 'Time', yAxis: 'Value'});
    chart.bind("#chart");
    chart.render();

    });
    </script>
-->
    <script>
    var lineArr = [];
    var MAX_LENGTH = 100;
    var duration = 500;
    var chart = realTimeLineChart();

    function randomNumberBounds(min, max) {
      return Math.floor(Math.random() * max) + min;
    }

    function seedData() {
      var now = new Date();
      for (var i = 0; i < MAX_LENGTH; ++i) {
        lineArr.push({
          time: new Date(now.getTime() - ((MAX_LENGTH - i) * duration)),
          x: randomNumberBounds(0, 5),
          y: randomNumberBounds(0, 2.5),
          z: randomNumberBounds(0, 10)
        });
      }
    }

    function updateData() {
      var now = new Date();

      var lineData = {
        time: now,
        x: randomNumberBounds(0, 5),
        y: randomNumberBounds(0, 2.5),
        z: randomNumberBounds(0, 10)
      };
      lineArr.push(lineData);

      if (lineArr.length > 30) {
        lineArr.shift();
      }
      d3.select("#chart").datum(lineArr).call(chart);
    }

    function resize() {
      if (d3.select("#chart svg").empty()) {
        return;
      }
      chart.width(+d3.select("#chart").style("width").replace(/(px)/g, ""));
      d3.select("#chart").call(chart);
    }

    document.addEventListener("DOMContentLoaded", function() {
      seedData();
      window.setInterval(updateData, 500);
      d3.select("#chart").datum(lineArr).call(chart);
      d3.select(window).on('resize', resize);
    });
    </script>

</body>
</html>
